uuid: f7e9c3d1-2b4a-4c5e-8f1a-9d3e5b7c9a1b
langcode: en
status: true
dependencies: {}
id: dynasty_player_csv_import
class: null
field_plugin_method: null
cck_plugin_method: null
migration_tags: null
migration_group: null
label: 'Import Patriots All-Time Roster from CSV'
source:
  plugin: csv
  path: 'public://csv/patriots_all_time_roster.csv'
  header_row_count: 1
  delimiter: ','
  ids:
    - Name
  constants:
    uid: 1
process:
  # Map player name (swap from "Last First" to "First Last")
  title:
    plugin: swap_player_name
    source: Name

  # Map jersey number
  field_jersey_number: Number

  # Map position to taxonomy term
  field_player_position:
    -
      plugin: entity_lookup
      source: Position
      entity_type: taxonomy_term
      bundle_key: vid
      bundle: position
      value_key: name
      access_check: 0
    -
      plugin: skip_on_empty
      method: process

  # Map college to taxonomy term (auto-create if doesn't exist)
  field_college:
    -
      plugin: entity_generate
      source: College
      entity_type: taxonomy_term
      bundle_key: vid
      bundle: college
      value_key: name
    -
      plugin: skip_on_empty
      method: process

  # Parse years field into individual seasons
  # This needs a custom process plugin to handle formats like:
  # "2004" (single year)
  # "1971-85" (range)
  # "1971-85 87" (range plus additional year)
  field_seasons_on_team:
    plugin: parse_player_years
    source: Years

  # Set the author
  uid: constants/uid

destination:
  plugin: 'entity:node'
  default_bundle: player

migration_dependencies:
  optional:
    - dynasty_taxonomy_import
