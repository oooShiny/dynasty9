{#
/**
 * @file
 * Theme override to display a Play entity.
 *
 * Available variables:
 * - play: The play entity.
 * - content: All play items.
 * - attributes: HTML attributes for the containing element.
 * - title_attributes: HTML attributes for the title.
 * - content_attributes: HTML attributes for the content wrapper.
 */
#}
{% set team = content.scoring_team.0['#context'].value %}
{% set css = '' %}
{% set play_link = false %}
{% if team == 'Patriots' %}
  {% set css = 'text-blue-pats font-bold' %}
  {% set play_link = true %}
{% else %}
  {% set css = 'text-' ~ team|lower ~ '-primary' %}
{% endif %}

<div class="flex flex-row {{ css }}">
  <div class="basis-1/6">{{ content.quarter }}</div>
  <div class="basis-1/2">
    {% if play.play_highlight.entity %}
      {% set highlight = play.play_highlight.entity %}
      {% set video_id = highlight.field_muse_video_id.value %}
      {% if video_id %}
        {% set modal_id = 'video_modal_' ~ play.id.value %}

        <button
          aria-haspopup="dialog"
          aria-expanded="false"
          aria-controls="hs-vertically-centered-modal"
          data-hs-overlay="#hs-vertically-centered-modal"
          class="btn btn-sm cursor-pointer">
          <img class="bg-red-100 h-4 inline" src="/themes/custom/dynasty_tw/icons/play-video.svg" />
        </button>


        {# Preline Modal #}
        <div id="hs-vertically-centered-modal" class="hs-overlay hidden size-full fixed top-0 start-0 z-80 overflow-x-hidden overflow-y-auto pointer-events-none" role="dialog" tabindex="-1" aria-labelledby="hs-vertically-centered-modal-label">
          <div class="hs-overlay-open:mt-7 hs-overlay-open:opacity-100 hs-overlay-open:duration-500 mt-0 opacity-0 ease-out transition-all sm:max-w-lg sm:w-full m-3 sm:mx-auto min-h-[calc(100%-56px)] flex items-center">
            <div class="w-full flex flex-col bg-white border border-gray-200 shadow-2xs rounded-xl pointer-events-auto dark:bg-neutral-800 dark:border-neutral-700 dark:shadow-neutral-700/70">
              <div class="flex justify-between items-center py-3 px-4 border-b border-gray-200 dark:border-neutral-700">
                <h3 id="hs-vertically-centered-modal-label" class="font-bold text-gray-800 dark:text-white">
                  {{ highlight.label }}
                </h3>
                <button type="button" class="size-8 inline-flex justify-center items-center gap-x-2 rounded-full border border-transparent bg-gray-100 text-gray-800 hover:bg-gray-200 focus:outline-hidden focus:bg-gray-200 disabled:opacity-50 disabled:pointer-events-none dark:bg-neutral-700 dark:hover:bg-neutral-600 dark:text-neutral-400 dark:focus:bg-neutral-600" aria-label="Close" data-hs-overlay="#hs-vertically-centered-modal">
                  <span class="sr-only">Close</span>
                  <svg class="shrink-0 size-4" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <path d="M18 6 6 18"></path>
                    <path d="m6 6 12 12"></path>
                  </svg>
                </button>
              </div>
              <div class="p-4 overflow-y-auto">
                <div class="aspect-video w-full">
                  <iframe
                    src="https://muse.ai/embed/{{ video_id }}?auto=0"
                    frameborder="0"
                    allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture"
                    allowfullscreen
                    class="w-full h-full"
                    title="{{ highlight.label }}"></iframe>
                </div>
              </div>
              <div class="flex justify-end items-center gap-x-2 py-3 px-4 border-t border-gray-200 dark:border-neutral-700">
                <button type="button" class="py-2 px-3 inline-flex items-center gap-x-2 text-sm font-medium rounded-lg border border-red-pats bg-white text-red-pats shadow-2xs hover:bg-gray-50 focus:outline-hidden focus:bg-gray-50 disabled:opacity-50 disabled:pointer-events-none dark:bg-neutral-800 dark:border-neutral-700 dark:text-white dark:hover:bg-neutral-700 dark:focus:bg-neutral-700" data-hs-overlay="#hs-vertically-centered-modal">
                  Close
                </button>
              </div>
            </div>
          </div>
        </div>
      {% endif %}
    {% endif %}
    <span class="italic">
      {% if play_link and is_admin %}
        <a href="/play/{{ play.id.value }}">
      {% endif %}
        {{ content.play_description.0['#text'] }}
      {% if play_link and is_admin %}
        </a>
      {% endif %}
    </span>
  </div>
  <div class="basis-1/6">{{ team }}</div>
  <div class="basis-1/6">{{ content.minutes.0['#markup'] }}:{{ "%02d"|format(content.seconds.0['#markup']) }}</div>
</div>

